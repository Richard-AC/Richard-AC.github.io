<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="theme" content="Chirpy v2.7.2"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="rdbg - A Rust library for writing custom Windows debuggers" /><meta name="author" content="RAC" /><meta property="og:locale" content="en_US" /><meta name="description" content="rdbg on Github" /><meta property="og:description" content="rdbg on Github" /><link rel="canonical" href="https://richard-ac.github.io/posts/rdbg/" /><meta property="og:url" content="https://richard-ac.github.io/posts/rdbg/" /><meta property="og:site_name" content="RAC Blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-02-27T08:00:00+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="rdbg - A Rust library for writing custom Windows debuggers" /><meta name="twitter:site" content="@twitter_username" /><meta name="twitter:creator" content="@RAC" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"RAC"},"description":"rdbg on Github","url":"https://richard-ac.github.io/posts/rdbg/","@type":"BlogPosting","headline":"rdbg - A Rust library for writing custom Windows debuggers","dateModified":"2023-02-27T23:49:56+08:00","datePublished":"2023-02-27T08:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://richard-ac.github.io/posts/rdbg/"},"@context":"https://schema.org"}</script><title>rdbg - A Rust library for writing custom Windows debuggers | RAC Blog</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="preload" href="/assets/css/post.css" as="style"><link rel="stylesheet" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/css/lib/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/css/lib/bootstrap-toc.min.css" /> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="/assets/js/post.min.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script defer src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script> <script defer src="/app.js"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=G-9VRMP80RNQ"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-9VRMP80RNQ'); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/sample/RAC.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">RAC Blog</a></div><div class="site-subtitle font-italic">Exploit Development, Vulnerability Research and Systems Programming</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/tabs/disclosures/" class="nav-link"> <i class="fa-fw fas fa-bug ml-xl-3 mr-xl-3 unloaded"></i> <span>DISCLOSURES</span> </a><li class="nav-item"> <a href="/tabs/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tabs/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/tabs/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/tabs/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/Richard-AC" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['0xrac','protonmail.com'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>rdbg - A Rust library for writing custom Windows debuggers</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>rdbg - A Rust library for writing custom Windows debuggers</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Mon, Feb 27, 2023, 8:00 AM +0800" > Feb 27 <i class="unloaded">2023-02-27T08:00:00+08:00</i> </span> by <span class="author"> RAC </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Mon, Feb 27, 2023, 10:49 AM -0500" > Feb 27 <i class="unloaded">2023-02-27T23:49:56+08:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1590 words">8 min</span></div></div><div class="post-content"><p><a href="https://github.com/Richard-AC/rdbg">rdbg on Github</a></p><h1 id="introduction">Introduction</h1><hr /><p>Writing a custom debugger can be very useful for many program analysis tasks. MSDN provides <a href="https://learn.microsoft.com/en-us/windows/win32/debug/writing-the-debugger-s-main-loop">a useful template</a> which I ended up using many times including in my <a href="https://github.com/Richard-AC/TriageTool">TriageTool</a> crash triaging tool which I mentionned in my previous post. However I got tired of copying this boilerplate code and have since ported all my tools to Rust which is why I decided to write <code class="language-plaintext highlighter-rouge">rdbg</code>.</p><p><code class="language-plaintext highlighter-rouge">rdbg</code> is a small Rust library with no dependencies. It provides Rust-friendly wrappers to the Windows debugging API and implements much of the boilerplate debugger code. It exposes APIs to spawn a process, read and write its memory, place breakpoints which execute a closure when reached, single step threads and provide callbacks for many debugging events.</p><p>While using one of the crates providing Rust bindings to the Windows API was a possibility, this usually results in non-idiomatic Rust code (e.g checking tags for enums instead of pattern matching) and requires extensive use of unsafe code.</p><p>In the next section I’ll present <code class="language-plaintext highlighter-rouge">rdbg</code>’s API. We’ll then go over two simple examples of using it, first to solve a reverse-engineering ctf challenge and then to triage crashes.</p><h1 id="rdbg">rdbg</h1><hr /><p><code class="language-plaintext highlighter-rouge">rdbg</code> is built around two components:</p><ul><li>The <code class="language-plaintext highlighter-rouge">Debugger</code> struct which allows spawning a process, running it, placing breakpoints, single stepping etc.<li>The <code class="language-plaintext highlighter-rouge">DbgCallbacks</code> trait which allows the user to define functions which will be called on various debugging events (thread creation, dll loading, access violation, etc.)</ul><p>We will now present them briefly but I recommend taking a look at the documentation (which can be generated with <code class="language-plaintext highlighter-rouge">cargo doc --open</code> from the root of the repository) for more details.</p><h2 id="debugger">Debugger</h2><p>The <code class="language-plaintext highlighter-rouge">Debugger</code> is used to spawn and run a process. Note that <code class="language-plaintext highlighter-rouge">spawn</code> accepts an <code class="language-plaintext highlighter-rouge">Option&lt;String&gt;</code> for <code class="language-plaintext highlighter-rouge">stdin</code> which will be fed to the target process’ stdin if provided.</p><div class="language-rust highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="c">/// Spawn a new process under the debugger.</span>
<span class="c">/// e.g cmdline = ["program_path", "arg1", "arg2", "arg3"]</span>
<span class="k">pub</span> <span class="k">fn</span> <span class="nf">spawn</span><span class="p">(</span><span class="n">cmdline</span><span class="p">:</span> <span class="o">&amp;</span><span class="p">[</span><span class="o">&amp;</span><span class="nb">str</span><span class="p">],</span> <span class="n">stdin</span><span class="p">:</span> <span class="nb">Option</span><span class="o">&lt;</span><span class="nb">String</span><span class="o">&gt;</span><span class="p">)</span> <span class="k">-&gt;</span> <span class="n">Self</span>

<span class="c">/// Run the process returning its exit code</span>
<span class="k">pub</span> <span class="k">fn</span> <span class="nf">run</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span> <span class="k">self</span><span class="p">,</span> <span class="n">cbs</span><span class="p">:</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="k">impl</span> <span class="n">DbgCallbacks</span><span class="p">)</span> <span class="k">-&gt;</span> <span class="nb">u32</span>
</pre></table></code></div></div><p>The <code class="language-plaintext highlighter-rouge">Debugger</code> can then be used to read and write the debuggee’s memory:</p><div class="language-rust highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="c">/// Attempts to read `buf.len()` bytes of memory at `addr` in the debugged</span>
<span class="c">/// process. Returns the number of bytes read.</span>
<span class="k">pub</span> <span class="k">fn</span> <span class="nf">read_mem</span><span class="p">(</span><span class="o">&amp;</span><span class="k">self</span><span class="p">,</span> <span class="n">addr</span><span class="p">:</span> <span class="o">*</span><span class="k">const</span> <span class="nb">u8</span><span class="p">,</span> <span class="n">buf</span><span class="p">:</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="p">[</span><span class="nb">u8</span><span class="p">])</span> <span class="k">-&gt;</span> <span class="nb">usize</span>

<span class="c">/// Attempts to write `buf.len()` bytes of memory to `addr` in the debugged</span>
<span class="c">/// process. Returns the number of bytes written.</span>
<span class="k">pub</span> <span class="k">fn</span> <span class="nf">write_mem</span><span class="p">(</span><span class="o">&amp;</span><span class="k">self</span><span class="p">,</span> <span class="n">addr</span><span class="p">:</span> <span class="o">*</span><span class="k">mut</span> <span class="nb">u8</span><span class="p">,</span> <span class="n">buf</span><span class="p">:</span> <span class="o">&amp;</span><span class="p">[</span><span class="nb">u8</span><span class="p">])</span> <span class="k">-&gt;</span> <span class="nb">usize</span>
</pre></table></code></div></div><p>The <code class="language-plaintext highlighter-rouge">Debugger</code> can place breakpoints and provide a closure to be executed when the breakpoint is hit. If the module hasn’t been loaded yet, the breakpoint is deferred and will be registered when the module gets loaded.</p><div class="language-rust highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="c">/// Registers a breakpoint at address &lt;module&gt;+off</span>
<span class="c">/// Upon reaching the address, the closure `cb` will be invoked. </span>
<span class="c">/// If `permanent` is false, the breakpoint is deleted after it's hit once</span>
<span class="c">/// If `permanent` is true, the breakpoint triggers every time the address</span>
<span class="c">/// is reached.</span>
<span class="k">pub</span> <span class="k">fn</span> <span class="nf">register_breakpoint</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span> <span class="k">self</span><span class="p">,</span> <span class="n">module</span><span class="p">:</span> <span class="o">&amp;</span><span class="nb">str</span><span class="p">,</span> <span class="n">off</span><span class="p">:</span> <span class="nb">usize</span><span class="p">,</span> 
                       <span class="n">cb</span><span class="p">:</span> <span class="nb">Box</span><span class="o">&lt;</span><span class="n">BreakpointCallback</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">permanent</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span>

<span class="c">/// Type of the closure called when a breakpoint is hit.</span>
<span class="c">/// Arguments are: (dbg: Debugger, pid: u32, tid: u32, exception: EXCEPTION_RECORD)</span>
<span class="k">pub</span> <span class="k">type</span> <span class="n">BreakpointCallback</span> <span class="o">=</span> <span class="n">dyn</span> <span class="nf">FnMut</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span> <span class="n">Debugger</span><span class="p">,</span> <span class="nb">u32</span><span class="p">,</span> <span class="nb">u32</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">EXCEPTION_RECORD</span><span class="p">);</span>
</pre></table></code></div></div><p>Finally, we can single-step threads:</p><div class="language-rust highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="c">/// Enable single stepping for thread `tid`</span>
<span class="k">pub</span> <span class="k">fn</span> <span class="nf">enable_single_stepping</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span> <span class="k">self</span><span class="p">,</span> <span class="n">tid</span><span class="p">:</span> <span class="nb">u32</span><span class="p">)</span>

<span class="c">/// Disable single stepping for thread `tid`. Has no effect if it was not </span>
<span class="c">/// enabled</span>
<span class="k">pub</span> <span class="k">fn</span> <span class="nf">disable_single_stepping</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span> <span class="k">self</span><span class="p">,</span> <span class="n">tid</span><span class="p">:</span> <span class="nb">u32</span><span class="p">)</span>
</pre></table></code></div></div><h2 id="dbgcallbacks">DbgCallbacks</h2><p>This trait allows the user to provide functions that will get called when a specific event occurs.</p><p>Here is the list of events currently available:</p><div class="language-rust highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre><span class="c">/// Called when the debugged process causes an exception</span>
<span class="k">fn</span> <span class="n">exception_cb</span>
<span class="c">/// Called on thread creation</span>
<span class="k">fn</span> <span class="n">create_thread_cb</span>
<span class="c">/// Called on process creation</span>
<span class="k">fn</span> <span class="n">create_process_cb</span>
<span class="c">/// Called on thread exit</span>
<span class="k">fn</span> <span class="n">exit_thread_cb</span>
<span class="c">/// Called on process exit</span>
<span class="k">fn</span> <span class="n">exit_process_cb</span>
<span class="c">/// Called on DLL load</span>
<span class="k">fn</span> <span class="n">dll_load_cb</span>
<span class="c">/// Called on DLL unload</span>
<span class="k">fn</span> <span class="n">dll_unload_cb</span>
<span class="c">/// Called when the debugged process causes an access violation</span>
<span class="k">fn</span> <span class="n">access_violation_cb</span>
<span class="c">/// Called on every single step</span>
<span class="k">fn</span> <span class="n">single_step_cb</span>
<span class="c">/// Called when the debugged process attempts to execute an illegal instruction</span>
<span class="k">fn</span> <span class="n">illegal_inst_cb</span>
<span class="c">/// Called when the debugged process divides by zero</span>
<span class="k">fn</span> <span class="n">div_by_zero_cb</span>
<span class="c">/// Called when the debugged process uses up its stack</span>
<span class="k">fn</span> <span class="n">stack_overflow_cb</span>
</pre></table></code></div></div><p>The user should implement this trait for a struct and pass it to the <code class="language-plaintext highlighter-rouge">Debugger</code>’s <code class="language-plaintext highlighter-rouge">run</code> method.</p><div class="language-rust highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="k">struct</span> <span class="n">MyAnalysis</span><span class="p">;</span>
<span class="k">impl</span> <span class="n">DbgCallbacks</span> <span class="k">for</span> <span class="n">MyAnalysis</span> <span class="p">{</span> <span class="p">}</span>
<span class="o">...</span>
<span class="k">let</span> <span class="k">mut</span> <span class="n">dbg</span> <span class="o">=</span> <span class="nn">Debugger</span><span class="p">::</span><span class="nf">spawn</span><span class="p">(</span><span class="o">&amp;</span><span class="p">[</span><span class="s">"program.exe"</span><span class="p">],</span> <span class="nb">None</span><span class="p">);</span>
<span class="n">dbg</span><span class="nf">.run</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span> <span class="n">MyAnalysis</span><span class="p">);</span>
</pre></table></code></div></div><h1 id="examples">Examples</h1><hr /><p>Let’s now go over two examples of using <code class="language-plaintext highlighter-rouge">rdbg</code>.</p><h2 id="solving-a-reverse-engineering-ctf-challenge">Solving a reverse-engineering CTF challenge</h2><p><a href="https://github.com/Richard-AC/rdbg/raw/main/examples/crackme_example/chall.exe">This CTF challenge</a> is a 32 bit executable. It accepts a password on <code class="language-plaintext highlighter-rouge">argv</code>, performs some checks in <code class="language-plaintext highlighter-rouge">check_password</code> and either prints <code class="language-plaintext highlighter-rouge">"Wrong Password :("</code> or <code class="language-plaintext highlighter-rouge">"Congrats! :)"</code>:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre>.text:004010DB         call    check_password
.text:004010E0         add     esp, 4
.text:004010E3         test    eax, eax
.text:004010E5         jz      short loc_4010FA
.text:004010E7         push    offset aCongrats ; "Congrats! :)\n"
.text:004010EC         call    puts
.text:004010F1         add     esp, 4
.text:004010F4         xor     eax, eax
.text:004010F6         jmp     short loc_40110C
.text:004010F8         jmp     short loc_40110C
.text:004010FA         push    offset aWrongPassword ; "Wrong password :(\n"
.text:004010FF         call    puts
</pre></table></code></div></div><p>Often, simple challenges rely on comparisons that stop as soon as an incorrect character is encountered. This means that if none of the characters are correct, the check fails immediately, if only the first character is correct, one check succeeds but the next one fails and so on. In other words, the more valid characters we provide, the further we will go in <code class="language-plaintext highlighter-rouge">check_password</code> before failing.</p><p>Therefore we can use the number of instructions executed during the password check as a side channel.</p><p>We can use <code class="language-plaintext highlighter-rouge">rdbg</code> to count the number of instructions executed in <code class="language-plaintext highlighter-rouge">check_password</code>. To do so, we will spawn the target binary under the debugger and single step the <code class="language-plaintext highlighter-rouge">check_password</code> function:</p><div class="language-rust highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="c">// Spawn chall.exe under the debugger without providing any stdin (this </span>
<span class="c">// challenge accepts input on argv).</span>
<span class="k">let</span> <span class="k">mut</span> <span class="n">dbg</span> <span class="o">=</span> <span class="nn">Debugger</span><span class="p">::</span><span class="nf">spawn</span><span class="p">(</span><span class="o">&amp;</span><span class="p">[</span><span class="s">"examples</span><span class="se">\\</span><span class="s">crackme_example</span><span class="se">\\</span><span class="s">chall.exe"</span><span class="p">,</span> <span class="n">pass</span><span class="p">],</span> <span class="nb">None</span><span class="p">);</span>

<span class="c">// Start single stepping when we reach the `call check_password` instruction</span>
<span class="n">dbg</span><span class="nf">.register_breakpoint</span><span class="p">(</span><span class="s">"chall.exe"</span><span class="p">,</span> <span class="mi">0x10DB</span><span class="p">,</span> <span class="nn">Box</span><span class="p">::</span><span class="nf">new</span><span class="p">(|</span><span class="n">dbg</span><span class="p">,</span> <span class="mi">_</span><span class="n">pid</span><span class="p">,</span> <span class="n">tid</span><span class="p">,</span> <span class="mi">_</span><span class="n">exception</span><span class="p">|</span> <span class="p">{</span>
    <span class="n">dbg</span><span class="nf">.enable_single_stepping</span><span class="p">(</span><span class="n">tid</span><span class="p">);</span>
<span class="p">}),</span> <span class="k">false</span><span class="p">);</span>

<span class="c">// Stop single stepping when we return from `check_password`</span>
<span class="n">dbg</span><span class="nf">.register_breakpoint</span><span class="p">(</span><span class="s">"chall.exe"</span><span class="p">,</span> <span class="mi">0x10E0</span><span class="p">,</span> <span class="nn">Box</span><span class="p">::</span><span class="nf">new</span><span class="p">(|</span><span class="n">dbg</span><span class="p">,</span> <span class="mi">_</span><span class="n">pid</span><span class="p">,</span> <span class="n">tid</span><span class="p">,</span> <span class="mi">_</span><span class="n">exception</span><span class="p">|</span> <span class="p">{</span>
    <span class="n">dbg</span><span class="nf">.disable_single_stepping</span><span class="p">(</span><span class="n">tid</span><span class="p">);</span>
<span class="p">}),</span> <span class="k">false</span><span class="p">);</span>
</pre></table></code></div></div><p>We now need to count the number of single steps performed during the execution:</p><div class="language-rust highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="c">/// An analysis which counts the number of single steps during the debuggee's </span>
<span class="c">/// execution.</span>
<span class="k">struct</span> <span class="nf">SingleStepCounter</span><span class="p">(</span><span class="nb">usize</span><span class="p">);</span>

<span class="k">impl</span> <span class="n">DbgCallbacks</span> <span class="k">for</span> <span class="n">SingleStepCounter</span> <span class="p">{</span>
    <span class="c">// This function gets called on each single step</span>
    <span class="k">fn</span> <span class="nf">single_step_cb</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span> <span class="k">self</span><span class="p">,</span> <span class="mi">_</span><span class="p">:</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="n">Debugger</span><span class="p">,</span> <span class="mi">_</span><span class="p">:</span> <span class="nb">u32</span><span class="p">,</span> <span class="mi">_</span><span class="p">:</span> <span class="nb">u32</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">self</span><span class="na">.0</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>We can then run the target program and retrieve the result:</p><div class="language-rust highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="k">let</span> <span class="k">mut</span> <span class="n">single_step_counter</span> <span class="o">=</span> <span class="nf">SingleStepCounter</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="n">dbg</span><span class="nf">.run</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span> <span class="n">single_step_counter</span><span class="p">);</span>
<span class="k">let</span> <span class="n">n_inst_executed</span> <span class="o">=</span> <span class="n">single_step_counter</span><span class="na">.0</span><span class="p">;</span>
</pre></table></code></div></div><p>Finally we need to write some brute force logic that tries every character for each position and always picks the one that leads to executing the most instructions. I’ll spare you the details but you can find the code <a href="https://github.com/Richard-AC/rdbg/blob/main/examples/crackme_example/src/main.rs">here</a>.</p><p>Output:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>C:\tools\rdbg&gt;cargo run -p crackme_example
S__________
S3_________
S3c________
S3cR_______
S3cR3______
S3cR3t_____
</pre></table></code></div></div><h2 id="writing-a-crash-analysis-tool">Writing a crash analysis tool</h2><p>Custom debuggers can also be useful to automate crash analysis. In this context, many callbacks in <a href="https://github.com/Richard-AC/rdbg/blob/main/rdbg/src/dbg_callbacks.rs">dbg_callbacks.rs</a> can be interesting such as <code class="language-plaintext highlighter-rouge">access_violation_cb</code>, <code class="language-plaintext highlighter-rouge">illegal_inst_cb</code>, <code class="language-plaintext highlighter-rouge">div_by_zero_cb</code> or <code class="language-plaintext highlighter-rouge">stack_overflow_cb</code> but to keep this example short, we will only report access violations.</p><p>Let’s define a function to be called when an access violation is triggered. It will parse the <a href="https://learn.microsoft.com/en-us/windows/win32/api/winnt/ns-winnt-exception_record">exception record</a> and display information about the crash:</p><div class="language-rust highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre><td class="rouge-code"><pre><span class="c">/// An analysis which prints information about a crashing program</span>
<span class="k">struct</span> <span class="n">CrashAnalysis</span><span class="p">;</span>
<span class="k">impl</span> <span class="n">DbgCallbacks</span> <span class="k">for</span> <span class="n">CrashAnalysis</span> <span class="p">{</span>
    <span class="k">fn</span> <span class="nf">access_violation_cb</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span> <span class="k">self</span><span class="p">,</span> <span class="n">dbg</span><span class="p">:</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="n">Debugger</span><span class="p">,</span> <span class="mi">_</span><span class="n">pid</span><span class="p">:</span> <span class="nb">u32</span><span class="p">,</span> <span class="mi">_</span><span class="n">tid</span><span class="p">:</span> <span class="nb">u32</span><span class="p">,</span> 
                           <span class="n">exception</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">EXCEPTION_RECORD</span><span class="p">,</span> <span class="n">first_chance</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="p">{</span>

        <span class="k">let</span> <span class="n">addr</span> <span class="o">=</span> <span class="n">exception</span><span class="py">.ExceptionAddress</span><span class="p">;</span>        

        <span class="c">// Resolve the address to module + offset</span>
        <span class="k">let</span> <span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">offset</span><span class="p">)</span> <span class="o">=</span> <span class="n">dbg</span><span class="nf">.resolve_addr</span><span class="p">(</span><span class="n">addr</span><span class="p">);</span>

        <span class="k">let</span> <span class="n">details</span> <span class="o">=</span> <span class="k">if</span> <span class="n">exception</span><span class="py">.NumberParameters</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="p">{</span>
            <span class="k">let</span> <span class="n">a</span> <span class="o">=</span> <span class="n">exception</span><span class="py">.ExceptionInformation</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
            <span class="k">let</span> <span class="n">av_type</span> <span class="o">=</span> <span class="k">match</span> <span class="n">exception</span><span class="py">.ExceptionInformation</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">{</span>
                <span class="mi">0</span> <span class="k">=&gt;</span> <span class="s">"read"</span><span class="p">,</span>
                <span class="mi">1</span> <span class="k">=&gt;</span> <span class="s">"write"</span><span class="p">,</span>
                <span class="mi">8</span> <span class="k">=&gt;</span> <span class="s">"exec"</span><span class="p">,</span>
                <span class="mi">_</span> <span class="k">=&gt;</span> <span class="nd">unreachable!</span><span class="p">(),</span>
            <span class="p">};</span>

            <span class="nd">format!</span><span class="p">(</span><span class="s">"Invalid {av_type} to {a:#x}"</span><span class="p">)</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span> <span class="nn">String</span><span class="p">::</span><span class="nf">new</span><span class="p">()</span> <span class="p">};</span>

        <span class="nd">println!</span><span class="p">(</span><span class="s">"Access Violation  @ {module}+{offset:#x} ({} chance). {}"</span><span class="p">,</span>
                 <span class="k">if</span> <span class="n">first_chance</span> <span class="p">{</span> <span class="s">"first"</span> <span class="p">}</span> <span class="k">else</span> <span class="p">{</span> <span class="s">"second"</span> <span class="p">},</span> <span class="n">details</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>We can then execute our crashing program under the debugger:</p><div class="language-rust highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="k">let</span> <span class="k">mut</span> <span class="n">dbg</span> <span class="o">=</span> <span class="nn">Debugger</span><span class="p">::</span><span class="nf">spawn</span><span class="p">(</span><span class="o">&amp;</span><span class="p">[</span><span class="s">"examples</span><span class="se">\\</span><span class="s">triage_example</span><span class="se">\\</span><span class="s">crash.exe"</span><span class="p">],</span> <span class="nb">None</span><span class="p">);</span>
<span class="n">dbg</span><span class="nf">.run</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span> <span class="n">CrashAnalysis</span><span class="p">);</span>
</pre></table></code></div></div><p>Once again, the code for this example is available <a href="https://github.com/Richard-AC/rdbg/blob/main/examples/triage_example/src/main.rs">here</a></p><p>Output:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>C:\tools\rdbg&gt;cargo run -p triage_example
Access Violation @ crash.exe+0x1019 (first chance). Invalid write to 0xc
Access Violation @ crash.exe+0x1019 (second chance). Invalid write to 0xc
</pre></table></code></div></div><h1 id="conclusion">Conclusion</h1><p>In this post, we introduced <code class="language-plaintext highlighter-rouge">rdbg</code>, a library for writing custom Windows debuggers in Rust. We then went over two use cases to show how one can use it to quickly automate program analysis tasks.</p><p>Don’t forget to check out the code of <a href="https://github.com/Richard-AC/rdbg">rdbg on Github</a>. I hope you’ll find it useful and welcome any PR or feedback.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/reverse-engineering/'>Reverse Engineering</a>, <a href='/categories/tooling/'>Tooling</a>, <a href='/categories/automation/'>Automation</a>, <a href='/categories/windows/'>Windows</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/windows/" class="post-tag no-text-decoration" >Windows</a> <a href="/tags/reverse-engineering/" class="post-tag no-text-decoration" >Reverse Engineering</a> <a href="/tags/debugging/" class="post-tag no-text-decoration" >Debugging</a> <a href="/tags/tooling/" class="post-tag no-text-decoration" >Tooling</a> <a href="/tags/automation/" class="post-tag no-text-decoration" >Automation</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=rdbg - A Rust library for writing custom Windows debuggers - RAC Blog&url=https://Richard-AC.github.io/posts/rdbg/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=rdbg - A Rust library for writing custom Windows debuggers - RAC Blog&u=https://Richard-AC.github.io/posts/rdbg/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=rdbg - A Rust library for writing custom Windows debuggers - RAC Blog&url=https://Richard-AC.github.io/posts/rdbg/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/rdbg/">rdbg - A Rust library for writing custom Windows debuggers</a><li><a href="/posts/fuzzing-brava/">Fuzzing Closed-Source Windows Programs</a><li><a href="/posts/old_page/">My portfolio</a><li><a href="/posts/SEH/">Clearing up Windows SEH exploitation</a><li><a href="/posts/sudo-cve/">Exploiting CVE-2021-3156 (sudo heap overflow)</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/windows/">Windows</a> <a class="post-tag" href="/tags/debugging/">Debugging</a> <a class="post-tag" href="/tags/exploits/">Exploits</a> <a class="post-tag" href="/tags/reverse-engineering/">Reverse Engineering</a> <a class="post-tag" href="/tags/archive/">archive</a> <a class="post-tag" href="/tags/automation/">Automation</a> <a class="post-tag" href="/tags/ctf/">CTF</a> <a class="post-tag" href="/tags/cve-2021-3156/">CVE-2021-3156</a> <a class="post-tag" href="/tags/cve/">CVE</a> <a class="post-tag" href="/tags/fuzzing/">Fuzzing</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/SEH/"><div class="card-body"> <span class="timeago small" > Jan 6, 2021 <i class="unloaded">2021-01-06T19:33:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Clearing up Windows SEH exploitation</h3><div class="text-muted small"><p> Introduction SEH is an exception handling mechanism used in Windows programs which has been abused by exploit writers for years. This Corelan article gives a good introduction to SEH and present...</p></div></div></a></div><div class="card"> <a href="/posts/fuzzing-brava/"><div class="card-body"> <span class="timeago small" > Sep 17, 2021 <i class="unloaded">2021-09-17T19:33:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Fuzzing Closed-Source Windows Programs</h3><div class="text-muted small"><p> Introduction This article describes how I harnessed and fuzzed a closed-source Windows program. Doing so, I found a few zero-days and got paid my first bounty ever! Target selection To select...</p></div></div></a></div><div class="card"> <a href="/posts/NORZH-sidechannel/"><div class="card-body"> <span class="timeago small" > May 25, 2021 <i class="unloaded">2021-05-25T19:33:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>CTF Writeup - NorzhCTF - S1de Ch4nnel</h3><div class="text-muted small"><p> Introduction S1de Ch4nnel was a challenge at NorzhCTF 2021. You can download the challenge here and my commented solution there. Challenge presentation When we ssh into the machine we are ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/fuzzing-brava/" class="btn btn-outline-primary"><p>Fuzzing Closed-Source Windows Programs</p></a> <span class="btn btn-outline-primary disabled"><p>-</p></span></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('#post-wrapper img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://twitter.com/username">Richard AC</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy/" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/windows/">Windows</a> <a class="post-tag" href="/tags/debugging/">Debugging</a> <a class="post-tag" href="/tags/exploits/">Exploits</a> <a class="post-tag" href="/tags/reverse-engineering/">Reverse Engineering</a> <a class="post-tag" href="/tags/archive/">archive</a> <a class="post-tag" href="/tags/automation/">Automation</a> <a class="post-tag" href="/tags/ctf/">CTF</a> <a class="post-tag" href="/tags/cve-2021-3156/">CVE 2021 3156</a> <a class="post-tag" href="/tags/cve/">CVE</a> <a class="post-tag" href="/tags/fuzzing/">Fuzzing</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script> <script> $(function() { let initTheme = "default"; if ($("html[mode=dark]").length > 0 || ($("html[mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches ) ) { initTheme = "dark"; } let mermaidConf = { theme: initTheme /* <default|dark|forest|neutral> */ }; /* Markdown converts to HTML */ $("pre").has("code.language-mermaid").each(function() { let svgCode = $(this).children().html(); $(this).addClass("unloaded"); $(this).after(`<div class=\"mermaid\">${svgCode}</div>`); }); mermaid.initialize(mermaidConf); }); </script><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://Richard-AC.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
